/*! Jcrop.js v2.0.4 - build: 20151117
 *  @copyright 2008-2015 Tapmodo Interactive LLC
 *  @license Free software under MIT License
 *  @website http://jcrop.org/
 **/
(function(g){var w=function(B,A){var C=navigator.userAgent.toLowerCase();this.opt=g.extend({},w.defaults,A||{});this.container=g(B);this.opt.is_msie=/msie/.test(C);this.opt.is_ie_lt9=/msie [1-8]\./.test(C);this.container.addClass(this.opt.css_container);this.ui={};this.state=null;this.ui.multi=[];this.ui.selection=null;this.filter={};this.init();this.setOptions(A);this.applySizeConstraints();this.container.trigger("cropinit",this);if(this.opt.is_ie_lt9){this.opt.dragEventTarget=document.body}};g.extend(w,{component:{},filter:{},stage:{},registerComponent:function(B,A){w.component[B]=A},registerFilter:function(A,B){w.filter[A]=B},registerStageType:function(B,A){w.stage[B]=A},attach:function(B,A){var C=new g.Jcrop(B,A);return C},imgCopy:function(B){var A=new Image;A.src=B.src;return A},imageClone:function(A){return g.Jcrop.supportsCanvas?w.canvasClone(A):w.imgCopy(A)},canvasClone:function(C){var B=document.createElement("canvas"),A=B.getContext("2d");g(B).width(C.width).height(C.height),B.width=C.naturalWidth;B.height=C.naturalHeight;A.drawImage(C,0,0,C.naturalWidth,C.naturalHeight);return B},propagate:function(E,B,D){for(var C=0,A=E.length;C<A;C++){if(B.hasOwnProperty(E[C])){D[E[C]]=B[E[C]]}}},getLargestBox:function(C,A,B){if((A/B)>C){return[B*C,B]}else{return[A,A/C]}},stageConstructor:function(D,B,F){var E=[];g.each(w.stage,function(G,H){E.push(H)});E.sort(function(H,G){return H.priority-G.priority});for(var C=0,A=E.length;C<A;C++){if(E[C].isSupported(D,B)){E[C].create(D,B,function(H,G){if(typeof F=="function"){F(H,G)}});break}}},supportsColorFade:function(){return g.fx.step.hasOwnProperty("backgroundColor")},wrapFromXywh:function(B){var A={x:B[0],y:B[1],w:B[2],h:B[3]};A.x2=A.x+A.w;A.y2=A.y+A.h;return A}});var q=function(){};g.extend(q,{isSupported:function(A,B){return true},priority:100,create:function(B,A,D){var C=new q;C.element=B;D.call(this,C,A)},prototype:{attach:function(A){this.init(A);A.ui.stage=this},triggerEvent:function(A){g(this.element).trigger(A);return this},getElement:function(){return this.element}}});w.registerStageType("Block",q);var z=function(){};z.prototype=new q();g.extend(z,{isSupported:function(A,B){if(A.tagName=="IMG"){return true}},priority:90,create:function(B,A,C){g.Jcrop.component.ImageLoader.attach(B,function(D,E){var F=new z;F.element=g(B).wrap("<div />").parent();F.element.width(D).height(E);F.imgsrc=B;if(typeof C=="function"){C.call(this,F,A)}})}});w.registerStageType("Image",z);var f=function(){this.angle=0;this.scale=1;this.scaleMin=0.2;this.scaleMax=1.25;this.offset=[0,0]};f.prototype=new z();g.extend(f,{isSupported:function(A,B){if(g.Jcrop.supportsCanvas&&(A.tagName=="IMG")){return true}},priority:60,create:function(D,A,E){var C=g(D);var B=g.extend({},A);g.Jcrop.component.ImageLoader.attach(D,function(F,G){var H=new f;C.hide();H.createCanvas(D,F,G);C.before(H.element);H.imgsrc=D;B.imgsrc=D;if(typeof E=="function"){E(H,B);H.redraw()}})}});g.extend(f.prototype,{init:function(A){this.core=A},setOffset:function(A,B){this.offset=[A,B];return this},setAngle:function(A){this.angle=A;return this},setScale:function(A){this.scale=this.boundScale(A);return this},boundScale:function(A){if(A<this.scaleMin){A=this.scaleMin}else{if(A>this.scaleMax){A=this.scaleMax}}return A},createCanvas:function(B,A,C){this.width=A;this.height=C;this.canvas=document.createElement("canvas");this.canvas.width=A;this.canvas.height=C;this.$canvas=g(this.canvas).width("100%").height("100%");this.context=this.canvas.getContext("2d");this.fillstyle="rgb(0,0,0)";this.element=this.$canvas.wrap("<div />").parent().width(A).height(C)},triggerEvent:function(A){this.$canvas.trigger(A);return this},clear:function(){this.context.fillStyle=this.fillstyle;this.context.fillRect(0,0,this.canvas.width,this.canvas.height);return this},redraw:function(){this.context.save();this.clear();this.context.translate(parseInt(this.width*0.5),parseInt(this.height*0.5));this.context.translate(this.offset[0]/this.core.opt.xscale,this.offset[1]/this.core.opt.yscale);this.context.rotate(this.angle*(Math.PI/180));this.context.scale(this.scale,this.scale);this.context.translate(-parseInt(this.width*0.5),-parseInt(this.height*0.5));this.context.drawImage(this.imgsrc,0,0,this.width,this.height);this.context.restore();this.$canvas.trigger("cropredraw");return this},setFillStyle:function(A){this.fillstyle=A;return this}});w.registerStageType("Canvas",f);var m=function(){this.minw=40;this.minh=40;this.maxw=0;this.maxh=0;this.core=null};g.extend(m.prototype,{tag:"backoff",priority:22,filter:function(A){var B=this.bound;if(A.x<B.minx){A.x=B.minx;A.x2=A.w+A.x}if(A.y<B.miny){A.y=B.miny;A.y2=A.h+A.y}if(A.x2>B.maxx){A.x2=B.maxx;A.x=A.x2-A.w}if(A.y2>B.maxy){A.y2=B.maxy;A.y=A.y2-A.h}return A},refresh:function(A){this.elw=A.core.container.width();this.elh=A.core.container.height();this.bound={minx:0+A.edge.w,miny:0+A.edge.n,maxx:this.elw+A.edge.e,maxy:this.elh+A.edge.s}}});w.registerFilter("backoff",m);var b=function(){this.core=null};g.extend(b.prototype,{tag:"constrain",priority:5,filter:function(A,B){if(B=="move"){if(A.x<this.minx){A.x=this.minx;A.x2=A.w+A.x}if(A.y<this.miny){A.y=this.miny;A.y2=A.h+A.y}if(A.x2>this.maxx){A.x2=this.maxx;A.x=A.x2-A.w}if(A.y2>this.maxy){A.y2=this.maxy;A.y=A.y2-A.h}}else{if(A.x<this.minx){A.x=this.minx}if(A.y<this.miny){A.y=this.miny}if(A.x2>this.maxx){A.x2=this.maxx}if(A.y2>this.maxy){A.y2=this.maxy}}A.w=A.x2-A.x;A.h=A.y2-A.y;return A},refresh:function(A){this.elw=A.core.container.width();this.elh=A.core.container.height();this.minx=0+A.edge.w;this.miny=0+A.edge.n;this.maxx=this.elw+A.edge.e;this.maxy=this.elh+A.edge.s}});w.registerFilter("constrain",b);var j=function(){this.core=null};g.extend(j.prototype,{tag:"extent",priority:12,offsetFromCorner:function(E,D,A){var B=D[0],C=D[1];switch(E){case"bl":return[A.x2-B,A.y,B,C];case"tl":return[A.x2-B,A.y2-C,B,C];case"br":return[A.x,A.y,B,C];case"tr":return[A.x,A.y2-C,B,C]}},getQuadrant:function(A){var C=A.opposite[0]-A.offsetx;var B=A.opposite[1]-A.offsety;if((C<0)&&(B<0)){return"br"}else{if((C>=0)&&(B>=0)){return"tl"}else{if((C<0)&&(B>=0)){return"tr"}}}return"bl"},filter:function(A,D,H){if(D=="move"){return A}var C=A.w,F=A.h,E=H.state,G=this.limits;var B=E?this.getQuadrant(E):"br";if(G.minw&&(C<G.minw)){C=G.minw}if(G.minh&&(F<G.minh)){F=G.minh}if(G.maxw&&(C>G.maxw)){C=G.maxw}if(G.maxh&&(F>G.maxh)){F=G.maxh}if((C==A.w)&&(F==A.h)){return A}return w.wrapFromXywh(this.offsetFromCorner(B,[C,F],A))},refresh:function(A){this.elw=A.core.container.width();this.elh=A.core.container.height();this.limits={minw:A.minSize[0],minh:A.minSize[1],maxw:A.maxSize[0],maxh:A.maxSize[1]}}});w.registerFilter("extent",j);var u=function(){this.stepx=1;this.stepy=1;this.core=null};g.extend(u.prototype,{tag:"grid",priority:19,filter:function(A){var B={x:Math.round(A.x/this.stepx)*this.stepx,y:Math.round(A.y/this.stepy)*this.stepy,x2:Math.round(A.x2/this.stepx)*this.stepx,y2:Math.round(A.y2/this.stepy)*this.stepy};B.w=B.x2-B.x;B.h=B.y2-B.y;return B}});w.registerFilter("grid",u);var d=function(){this.ratio=0;this.core=null};g.extend(d.prototype,{tag:"ratio",priority:15,offsetFromCorner:function(E,D,A){var B=D[0],C=D[1];switch(E){case"bl":return[A.x2-B,A.y,B,C];case"tl":return[A.x2-B,A.y2-C,B,C];case"br":return[A.x,A.y,B,C];case"tr":return[A.x,A.y2-C,B,C]}},getBoundRatio:function(A,B){var C=w.getLargestBox(this.ratio,A.w,A.h);return w.wrapFromXywh(this.offsetFromCorner(B,C,A))},getQuadrant:function(A){var C=A.opposite[0]-A.offsetx;var B=A.opposite[1]-A.offsety;if((C<0)&&(B<0)){return"br"}else{if((C>=0)&&(B>=0)){return"tl"}else{if((C<0)&&(B>=0)){return"tr"}}}return"bl"},filter:function(A,D,F){if(!this.ratio){return A}var C=A.w/A.h;var E=F.state;var B=E?this.getQuadrant(E):"br";D=D||"se";if(D=="move"){return A}switch(D){case"n":A.x2=this.elw;A.w=A.x2-A.x;B="tr";break;case"s":A.x2=this.elw;A.w=A.x2-A.x;B="br";break;case"e":A.y2=this.elh;A.h=A.y2-A.y;B="br";break;case"w":A.y2=this.elh;A.h=A.y2-A.y;B="bl";break}return this.getBoundRatio(A,B)},refresh:function(A){this.ratio=A.aspectRatio;this.elw=A.core.container.width();this.elh=A.core.container.height()}});w.registerFilter("ratio",d);var p=function(){this.core=null};g.extend(p.prototype,{tag:"round",priority:90,filter:function(A){var B={x:Math.round(A.x),y:Math.round(A.y),x2:Math.round(A.x2),y2:Math.round(A.y2)};B.w=B.x2-B.x;B.h=B.y2-B.y;return B}});w.registerFilter("round",p);var e=function(B,A){this.color=A||"black";this.opacity=B||0.5;this.core=null;this.shades={}};g.extend(e.prototype,{tag:"shader",fade:true,fadeEasing:"swing",fadeSpeed:320,priority:95,init:function(){var A=this;if(!A.attached){A.visible=false;A.container=g("<div />").addClass(A.core.opt.css_shades).prependTo(this.core.container).hide();A.elh=this.core.container.height();A.elw=this.core.container.width();A.shades={top:A.createShade(),right:A.createShade(),left:A.createShade(),bottom:A.createShade()};A.attached=true}},destroy:function(){this.container.remove()},setColor:function(A,B){var C=this;if(A==C.color){return C}this.color=A;var D=w.supportsColorFade();g.each(C.shades,function(E,F){if(!C.fade||B||!D){F.css("backgroundColor",A)}else{F.animate({backgroundColor:A},{queue:false,duration:C.fadeSpeed,easing:C.fadeEasing})}});return C},setOpacity:function(B,A){var C=this;if(B==C.opacity){return C}C.opacity=B;g.each(C.shades,function(D,E){if(!C.fade||A){E.css({opacity:B})}else{E.animate({opacity:B},{queue:false,duration:C.fadeSpeed,easing:C.fadeEasing})}});return C},createShade:function(){return g("<div />").css({position:"absolute",backgroundColor:this.color,opacity:this.opacity}).appendTo(this.container)},refresh:function(C){var A=this.core,B=this.shades;this.setColor(C.bgColor?C.bgColor:this.core.opt.bgColor);this.setOpacity(C.bgOpacity?C.bgOpacity:this.core.opt.bgOpacity);this.elh=A.container.height();this.elw=A.container.width();B.right.css("height",this.elh+"px");B.left.css("height",this.elh+"px")},filter:function(A,B,E){if(!E.active){return A}var C=this,D=C.shades;D.top.css({left:Math.round(A.x)+"px",width:Math.round(A.w)+"px",height:Math.round(A.y)+"px"});D.bottom.css({top:Math.round(A.y2)+"px",left:Math.round(A.x)+"px",width:Math.round(A.w)+"px",height:(C.elh-Math.round(A.y2))+"px"});D.right.css({left:Math.round(A.x2)+"px",width:(C.elw-Math.round(A.x2))+"px"});D.left.css({width:Math.round(A.x)+"px"});if(!C.visible){C.container.show();C.visible=true}return A}});w.registerFilter("shader",e);var t=function(A){this.stage=A;this.core=A.core;this.cloneStagePosition()};t.prototype={cloneStagePosition:function(){var A=this.stage;this.angle=A.angle;this.scale=A.scale;this.offset=A.offset},getElement:function(){var A=this.stage;return g("<div />").css({position:"absolute",top:A.offset[0]+"px",left:A.offset[1]+"px",width:A.angle+"px",height:A.scale+"px"})},animate:function(A){var B=this;this.scale=this.stage.boundScale(this.scale);B.stage.triggerEvent("croprotstart");B.getElement().animate({top:B.offset[0]+"px",left:B.offset[1]+"px",width:B.angle+"px",height:B.scale+"px"},{easing:B.core.opt.animEasing,duration:B.core.opt.animDuration,complete:function(){B.stage.triggerEvent("croprotend");(typeof A=="function")&&A.call(this)},progress:function(F){var E={},D,C=F.tweens;for(D=0;D<C.length;D++){E[C[D].prop]=C[D].now}B.stage.setAngle(E.width).setScale(E.height).setOffset(E.top,E.left).redraw()}})}};w.stage.Canvas.prototype.getAnimator=function(){return new t(this)};w.registerComponent("CanvasAnimator",t);var h=function(A){this.selection=A;this.core=A.core};h.prototype={getElement:function(){var A=this.selection.get();return g("<div />").css({position:"absolute",top:A.y+"px",left:A.x+"px",width:A.w+"px",height:A.h+"px"})},animate:function(B,F,C,E,A){var D=this;D.selection.allowResize(false);D.getElement().animate({top:F+"px",left:B+"px",width:C+"px",height:E+"px"},{easing:D.core.opt.animEasing,duration:D.core.opt.animDuration,complete:function(){D.selection.allowResize(true);A&&A.call(this)},progress:function(K){var J={},I,H=K.tweens;for(I=0;I<H.length;I++){J[H[I].prop]=H[I].now}var G={x:parseInt(J.left),y:parseInt(J.top),w:parseInt(J.width),h:parseInt(J.height)};G.x2=G.x+G.w;G.y2=G.y+G.h;D.selection.updateRaw(G,"se")}})}};w.registerComponent("Animator",h);var y=function(E,C,A){var B=this;B.x=E.pageX;B.y=E.pageY;B.selection=C;B.eventTarget=C.core.opt.dragEventTarget;B.orig=C.get();C.callFilterFunction("refresh");var D=C.core.container.position();B.elx=D.left;B.ely=D.top;B.offsetx=0;B.offsety=0;B.ord=A;B.opposite=B.getOppositeCornerOffset();B.initEvents(E)};y.prototype={getOppositeCornerOffset:function(){var C=this.orig;var B=this.x-this.elx-C.x;var A=this.y-this.ely-C.y;switch(this.ord){case"nw":case"w":return[C.w-B,C.h-A];return[C.x+C.w,C.y+C.h];case"sw":return[C.w-B,-A];return[C.x+C.w,C.y];case"se":case"s":case"e":return[-B,-A];return[C.x,C.y];case"ne":case"n":return[-B,C.h-A];return[C.w,C.y+C.h]}return[null,null]},initEvents:function(A){g(this.eventTarget).on("mousemove.jcrop",this.createDragHandler()).on("mouseup.jcrop",this.createStopHandler())},dragEvent:function(A){this.offsetx=A.pageX-this.x;this.offsety=A.pageY-this.y;this.selection.updateRaw(this.getBox(),this.ord)},endDragEvent:function(B){var A=this.selection;A.core.container.removeClass("jcrop-dragging");A.element.trigger("cropend",[A,A.core.unscale(A.get())]);A.focus()},createStopHandler:function(){var A=this;return function(B){g(A.eventTarget).off(".jcrop");A.endDragEvent(B);return false}},createDragHandler:function(){var A=this;return function(B){A.dragEvent(B);return false}},update:function(A,C){var B=this;B.offsetx=A-B.x;B.offsety=C-B.y},resultWrap:function(B){var A={x:Math.min(B[0],B[2]),y:Math.min(B[1],B[3]),x2:Math.max(B[0],B[2]),y2:Math.max(B[1],B[3])};A.w=A.x2-A.x;A.h=A.y2-A.y;return A},getBox:function(){var B=this;var C=B.orig;var A={x2:C.x+C.w,y2:C.y+C.h};switch(B.ord){case"n":return B.resultWrap([C.x,B.offsety+C.y,A.x2,A.y2]);case"s":return B.resultWrap([C.x,C.y,A.x2,B.offsety+A.y2]);case"e":return B.resultWrap([C.x,C.y,B.offsetx+A.x2,A.y2]);case"w":return B.resultWrap([C.x+B.offsetx,C.y,A.x2,A.y2]);case"sw":return B.resultWrap([B.offsetx+C.x,C.y,A.x2,B.offsety+A.y2]);case"se":return B.resultWrap([C.x,C.y,B.offsetx+A.x2,B.offsety+A.y2]);case"ne":return B.resultWrap([C.x,B.offsety+C.y,B.offsetx+A.x2,A.y2]);case"nw":return B.resultWrap([B.offsetx+C.x,B.offsety+C.y,A.x2,A.y2]);case"move":A.nx=C.x+B.offsetx;A.ny=C.y+B.offsety;return B.resultWrap([A.nx,A.ny,A.nx+C.w,A.ny+C.h])}}};w.registerComponent("DragState",y);var x=function(A){this.core=A};x.prototype={on:function(B,A){g(this).on(B,A)},off:function(A){g(this).off(A)},trigger:function(A){g(this).trigger(A)}};w.registerComponent("EventManager",x);var k=function(C,B,A){this.src=C;if(!B){B=new Image}this.element=B;this.callback=A;this.load()};g.extend(k,{attach:function(B,A){return new k(B.src,B,A)},prototype:{getDimensions:function(){var A=this.element;if(A.naturalWidth){return[A.naturalWidth,A.naturalHeight]}if(A.width){return[A.width,A.height]}return null},fireCallback:function(){this.element.onload=null;if(typeof this.callback=="function"){this.callback.apply(this,this.getDimensions())}},isLoaded:function(){return this.element.complete},load:function(){var A=this;var B=A.element;B.src=A.src;if(A.isLoaded()){A.fireCallback()}else{A.element.onload=function(C){A.fireCallback()}}}}});w.registerComponent("ImageLoader",k);var o=function(A){this.core=A;this.init()};g.extend(o,{support:function(){if(("ontouchstart" in window)||navigator.msMaxTouchPoints>0||window.DocumentTouch&&document instanceof DocumentTouch){return true}},prototype:{init:function(){var A=this,B=g.Jcrop.component.DragState.prototype;if(!B.touch){A.initEvents();A.shimDragState();A.shimStageDrag();B.touch=true}},shimDragState:function(){var A=this;g.Jcrop.component.DragState.prototype.initEvents=function(B){if(B.type.substr(0,5)=="touch"){g(this.eventTarget).on("touchmove.jcrop.jcrop-touch",A.dragWrap(this.createDragHandler())).on("touchend.jcrop.jcrop-touch",this.createStopHandler())}else{g(this.eventTarget).on("mousemove.jcrop",this.createDragHandler()).on("mouseup.jcrop",this.createStopHandler())}}},shimStageDrag:function(){this.core.container.addClass("jcrop-touch").on("touchstart.jcrop.jcrop-stage",this.dragWrap(this.core.ui.manager.startDragHandler()))},dragWrap:function(A){return function(B){B.preventDefault();B.stopPropagation();if(B.type.substr(0,5)=="touch"){B.pageX=B.originalEvent.changedTouches[0].pageX;B.pageY=B.originalEvent.changedTouches[0].pageY;return A(B)}return false}},initEvents:function(){var A=this,B=A.core;B.container.on("touchstart.jcrop.jcrop-touch","."+B.opt.css_drag,A.dragWrap(B.startDrag()))}}});w.registerComponent("Touch",o);var s=function(A){this.core=A;this.init()};g.extend(s,{defaults:{eventName:"keydown.jcrop",passthru:[9],debug:false},prototype:{init:function(){g.extend(this,s.defaults);this.enable()},disable:function(){this.core.container.off(this.eventName)},enable:function(){var B=this,A=B.core;A.container.on(B.eventName,function(D){var C=D.shiftKey?16:2;if(g.inArray(D.keyCode,B.passthru)>=0){return true}switch(D.keyCode){case 37:A.nudge(-C,0);break;case 38:A.nudge(0,-C);break;case 39:A.nudge(C,0);break;case 40:A.nudge(0,C);break;case 46:case 8:A.requestDelete();return false;break;default:if(B.debug){console.log("keycode: "+D.keyCode)}break}if(!D.metaKey&&!D.ctrlKey){D.preventDefault()}})}}});w.registerComponent("Keyboard",s);var c=function(){};g.extend(c,{defaults:{minSize:[8,8],maxSize:[0,0],aspectRatio:0,edge:{n:0,s:0,e:0,w:0},bgColor:null,bgOpacity:null,last:null,state:null,active:true,linked:true,canDelete:true,canDrag:true,canResize:true,canSelect:true},prototype:{init:function(A){this.core=A;this.startup();this.linked=this.core.opt.linked;this.attach();this.setOptions(this.core.opt);A.container.trigger("cropcreate",[this])},attach:function(){},startup:function(){var A=this,B=A.core.opt;g.extend(A,c.defaults);A.filter=A.core.getDefaultFilters();A.element=g("<div />").addClass(B.css_selection).data({selection:A});A.frame=g("<button />").addClass(B.css_button).data("ord","move").attr("type","button");A.element.append(A.frame).appendTo(A.core.container);if(A.core.opt.is_msie){A.frame.css({opacity:0,backgroundColor:"white"})}A.insertElements();A.frame.on("focus.jcrop",function(C){A.core.setSelection(A);A.element.trigger("cropfocus",A);A.element.addClass("jcrop-focus")}).on("blur.jcrop",function(C){A.element.removeClass("jcrop-focus");A.element.trigger("cropblur",A)})},propagate:["canDelete","canDrag","canResize","canSelect","minSize","maxSize","aspectRatio","edge"],setOptions:function(A){w.propagate(this.propagate,A,this);this.refresh();return this},refresh:function(){this.allowResize();this.allowDrag();this.allowSelect();this.callFilterFunction("refresh");this.updateRaw(this.get(),"se")},callFilterFunction:function(C,A){for(var B=0;B<this.filter.length;B++){if(this.filter[B][C]){this.filter[B][C](this)}}return this},addFilter:function(A){A.core=this.core;if(!this.hasFilter(A)){this.filter.push(A);this.sortFilters();if(A.init){A.init()}this.refresh()}},hasFilter:function(B){var A,C=this.filter,D=[];for(A=0;A<C.length;A++){if(C[A]===B){return true}}},sortFilters:function(){this.filter.sort(function(A,B){return A.priority-B.priority})},clearFilters:function(){var A,B=this.filter;for(var A=0;A<B.length;A++){if(B[A].destroy){B[A].destroy()}}this.filter=[]},removeFilter:function(A){var B,C=this.filter,D=[];for(var B=0;B<C.length;B++){if((C[B].tag&&(C[B].tag==A))||(A===C[B])){if(C[B].destroy){C[B].destroy()}}else{D.push(C[B])}}this.filter=D},runFilters:function(A,B){for(var C=0;C<this.filter.length;C++){A=this.filter[C].filter(A,B,this)}return A},endDrag:function(){if(this.state){g(document.body).off(".jcrop");this.focus();this.state=null}},startDrag:function(D,B){var C=this;var A=C.core;B=B||g(D.target).data("ord");this.focus();if((B=="move")&&C.element.hasClass(C.core.opt.css_nodrag)){return false}this.state=new w.component.DragState(D,this,B);return false},allowSelect:function(A){if(A===undefined){A=this.canSelect}if(A&&this.canSelect){this.frame.attr("disabled",false)}else{this.frame.attr("disabled","disabled")}return this},allowDrag:function(A){var B=this,C=B.core.opt;if(A==undefined){A=B.canDrag}if(A&&B.canDrag){B.element.removeClass(C.css_nodrag)}else{B.element.addClass(C.css_nodrag)}return this},allowResize:function(A){var B=this,C=B.core.opt;if(A==undefined){A=B.canResize}if(A&&B.canResize){B.element.removeClass(C.css_noresize)}else{B.element.addClass(C.css_noresize)}return this},remove:function(){this.element.trigger("cropremove",this);this.element.remove()},toBack:function(){this.active=false;this.element.removeClass("jcrop-current jcrop-focus")},toFront:function(){this.active=true;this.element.addClass("jcrop-current");this.callFilterFunction("refresh");this.refresh()},redraw:function(A){this.moveTo(A.x,A.y);this.resize(A.w,A.h);this.last=A;return this},update:function(A,B){return this.updateRaw(this.core.scale(A),B)},updateRaw:function(A,B){A=this.runFilters(A,B);this.redraw(A);this.element.trigger("cropmove",[this,this.core.unscale(A)]);return this},animateTo:function(D,B){var C=new w.component.Animator(this),A=this.core.scale(w.wrapFromXywh(D));C.animate(A.x,A.y,A.w,A.h,B)},center:function(D){var C=this.get(),B=this.core;var A=B.container.width(),E=B.container.height();var F=[(A-C.w)/2,(E-C.h)/2,C.w,C.h];return this[D?"setSelect":"animateTo"](F)},createElement:function(B,A){return g("<div />").addClass(B+" ord-"+A).data("ord",A)},moveTo:function(A,B){this.element.css({top:B+"px",left:A+"px"})},blur:function(){this.element.blur();return this},focus:function(){this.core.setSelection(this);this.frame.focus();return this},resize:function(A,B){this.element.css({width:A+"px",height:B+"px"})},get:function(){var A=this.element,D=A.position(),B=A.width(),C=A.height(),E={x:D.left,y:D.top};E.x2=E.x+B;E.y2=E.y+C;E.w=B;E.h=C;return E},insertElements:function(){var E=this,D,B=E.core,C=E.element,H=E.core.opt,A=H.borders,F=H.handles,G=H.dragbars;for(D=0;D<G.length;D++){C.append(E.createElement(H.css_dragbars,G[D]))}for(D=0;D<F.length;D++){C.append(E.createElement(H.css_handles,F[D]))}for(D=0;D<A.length;D++){C.append(E.createElement(H.css_borders,A[D]))}}}});w.registerComponent("Selection",c);var a=function(B,A){g.extend(this,a.defaults,A||{});this.manager=B;this.core=B.core};a.defaults={offset:[-8,-8],active:true,minsize:[20,20]};g.extend(a.prototype,{start:function(E){var H=this.core;if(!H.opt.allowSelect){return}if(H.opt.multi&&H.opt.multiMax&&(H.ui.multi.length>=H.opt.multiMax)){return false}var F=g(E.currentTarget).offset();var B=E.pageX-F.left+this.offset[0];var G=E.pageY-F.top+this.offset[1];var A=H.ui.multi;if(!H.opt.multi){if(H.opt.multiCleanup){for(var C=0;C<A.length;C++){A[C].remove()}H.ui.multi=[]}else{H.removeSelection(H.ui.selection)}}H.container.addClass("jcrop-dragging");var D=H.newSelection().updateRaw(w.wrapFromXywh([B,G,1,1]));D.element.trigger("cropstart",[D,this.core.unscale(D.get())]);return D.startDrag(E,"se")},end:function(B,C){this.drag(B,C);var A=this.sel.get();this.core.container.removeClass("jcrop-dragging");if((A.w<this.minsize[0])||(A.h<this.minsize[1])){this.core.requestDelete()}else{this.sel.focus()}}});w.registerComponent("StageDrag",a);var v=function(A){this.core=A;this.ui=A.ui;this.init()};g.extend(v.prototype,{init:function(){this.setupEvents();this.dragger=new a(this)},tellConfigUpdate:function(C){for(var D=0,A=this.ui.multi,B=A.length;D<B;D++){if(A[D].setOptions&&(A[D].linked||(this.core.opt.linkCurrent&&A[D]==this.ui.selection))){A[D].setOptions(C)}}},startDragHandler:function(){var A=this;return function(B){if(!B.button||A.core.opt.is_ie_lt9){return A.dragger.start(B)}}},removeEvents:function(){this.core.event.off(".jcrop-stage");this.core.container.off(".jcrop-stage")},shimLegacyHandlers:function(C){var B={},A=this.core,D;g.each(A.opt.legacyHandlers,function(E,F){if(E in C){D=C[E];A.container.off(".jcrop-"+E).on(F+".jcrop.jcrop-"+E,function(H,G,I){D.call(A,I)});delete C[E]}})},setupEvents:function(){var A=this,B=A.core;B.event.on("configupdate.jcrop-stage",function(C){A.shimLegacyHandlers(B.opt);A.tellConfigUpdate(B.opt);B.container.trigger("cropconfig",[B,B.opt])});this.core.container.on("mousedown.jcrop.jcrop-stage",this.startDragHandler())}});w.registerComponent("StageManager",v);var l=function(){};g.extend(l,{defaults:{selection:null,fading:true,fadeDelay:1000,fadeDuration:1000,autoHide:false,width:80,height:80,_hiding:null},prototype:{recopyCanvas:function(){var B=this.core.ui.stage,A=B.context;this.context.putImageData(A.getImageData(0,0,B.canvas.width,B.canvas.height),0,0)},init:function(A,B){var C=this;this.core=A;g.extend(this,l.defaults,B);C.initEvents();C.refresh();C.insertElements();if(C.selection){C.renderSelection(C.selection);C.selectionTarget=C.selection.element[0]}else{if(C.core.ui.selection){C.renderSelection(C.core.ui.selection)}}if(C.core.ui.stage.canvas){C.context=C.preview[0].getContext("2d");C.core.container.on("cropredraw",function(D){C.recopyCanvas();C.refresh()})}},updateImage:function(A){this.preview.remove();this.preview=g(g.Jcrop.imageClone(A));this.element.append(this.preview);this.refresh();return this},insertElements:function(){this.preview=g(g.Jcrop.imageClone(this.core.ui.stage.imgsrc));this.element=g("<div />").addClass("jcrop-thumb").width(this.width).height(this.height).append(this.preview).appendTo(this.core.container)},resize:function(A,B){this.width=A;this.height=B;this.element.width(A).height(B);this.renderCoords(this.last)},refresh:function(){this.cw=(this.core.opt.xscale*this.core.container.width());this.ch=(this.core.opt.yscale*this.core.container.height());if(this.last){this.renderCoords(this.last)}},renderCoords:function(C){var B=this.width/C.w;var A=this.height/C.h;this.preview.css({width:Math.round(B*this.cw)+"px",height:Math.round(A*this.ch)+"px",marginLeft:"-"+Math.round(B*C.x)+"px",marginTop:"-"+Math.round(A*C.y)+"px"});this.last=C;return this},renderSelection:function(A){return this.renderCoords(A.core.unscale(A.get()))},selectionStart:function(A){this.renderSelection(A)},show:function(){if(this._hiding){clearTimeout(this._hiding)}if(!this.fading){this.element.stop().css({opacity:1})}else{this.element.stop().animate({opacity:1},{duration:80,queue:false})}},hide:function(){var A=this;if(!A.fading){A.element.hide()}else{A._hiding=setTimeout(function(){A._hiding=null;A.element.stop().animate({opacity:0},{duration:A.fadeDuration,queue:false})},A.fadeDelay)}},initEvents:function(){var A=this;A.core.container.on("croprotstart croprotend cropimage cropstart cropmove cropend",function(C,B,D){if(A.selectionTarget&&(A.selectionTarget!==C.target)){return false}switch(C.type){case"cropimage":A.updateImage(D);break;case"cropstart":A.selectionStart(B);case"croprotstart":A.show();break;case"cropend":A.renderCoords(D);case"croprotend":if(A.autoHide){A.hide()}break;case"cropmove":A.renderCoords(D);break}})}}});w.registerComponent("Thumbnailer",l);var r=function(){};r.prototype={init:function(A,C,D){var B=this;if(!C){C=A.container}this.$btn=g(C);this.$targ=g(C);this.core=A;this.$btn.addClass("dialdrag").on("mousedown.dialdrag",this.mousedown()).data("dialdrag",this);if(!g.isFunction(D)){D=function(){}}this.callback=D;this.ondone=D},remove:function(){this.$btn.removeClass("dialdrag").off(".dialdrag").data("dialdrag",null);return this},setTarget:function(A){this.$targ=g(A);return this},getOffset:function(){var A=this.$targ,B=A.offset();return[B.left+(A.width()/2),B.top+(A.height()/2)]},relMouse:function(D){var A=D.pageX-this.offset[0],E=D.pageY-this.offset[1],B=Math.atan2(E,A)*(180/Math.PI),C=Math.sqrt(Math.pow(A,2)+Math.pow(E,2));return[A,E,B,C]},mousedown:function(){var C=this;function A(D){g(window).off(".dialdrag");C.ondone.call(C,C.relMouse(D));C.core.container.trigger("croprotend")}function B(D){C.callback.call(C,C.relMouse(D))}return function(E){C.offset=C.getOffset();var D=C.relMouse(E);C.angleOffset=-C.core.ui.stage.angle+D[2];C.distOffset=D[3];C.dragOffset=[D[0],D[1]];C.core.container.trigger("croprotstart");g(window).on("mousemove.dialdrag",B).on("mouseup.dialdrag",A);C.callback.call(C,C.relMouse(E));return false}}};w.registerComponent("DialDrag",r);w.defaults={edge:{n:0,s:0,e:0,w:0},setSelect:null,linked:true,linkCurrent:true,canDelete:true,canSelect:true,canDrag:true,canResize:true,eventManagerComponent:w.component.EventManager,keyboardComponent:w.component.Keyboard,dragstateComponent:w.component.DragState,stagemanagerComponent:w.component.StageManager,animatorComponent:w.component.Animator,selectionComponent:w.component.Selection,stageConstructor:w.stageConstructor,allowSelect:true,multi:false,multiMax:false,multiCleanup:true,animation:true,animEasing:"swing",animDuration:400,fading:true,fadeDuration:300,fadeEasing:"swing",bgColor:"black",bgOpacity:0.5,applyFilters:["constrain","extent","backoff","ratio","shader","round"],borders:["e","w","s","n"],handles:["n","s","e","w","sw","ne","nw","se"],dragbars:["n","e","w","s"],dragEventTarget:window,xscale:1,yscale:1,boxWidth:null,boxHeight:null,css_nodrag:"jcrop-nodrag",css_drag:"jcrop-drag",css_container:"jcrop-active",css_shades:"jcrop-shades",css_selection:"jcrop-selection",css_borders:"jcrop-border",css_handles:"jcrop-handle jcrop-drag",css_button:"jcrop-box jcrop-drag",css_noresize:"jcrop-noresize",css_dragbars:"jcrop-dragbar jcrop-drag",legacyHandlers:{onChange:"cropmove",onSelect:"cropend"}};g.extend(w.prototype,{init:function(){this.event=new this.opt.eventManagerComponent(this);this.ui.keyboard=new this.opt.keyboardComponent(this);this.ui.manager=new this.opt.stagemanagerComponent(this);this.applyFilters();if(g.Jcrop.supportsTouch){new g.Jcrop.component.Touch(this)}this.initEvents()},applySizeConstraints:function(){var B=this.opt,E=this.opt.imgsrc;if(E){var C=E.naturalWidth||E.width,J=E.naturalHeight||E.height,I=B.boxWidth||C,D=B.boxHeight||J;if(E&&((C>I)||(J>D))){var H=w.getLargestBox(C/J,I,D);g(E).width(H[0]).height(H[1]);this.resizeContainer(H[0],H[1]);this.opt.xscale=C/H[0];this.opt.yscale=J/H[1]}}if(this.opt.trueSize){var A=this.opt.trueSize[0];var G=this.opt.trueSize[1];var F=this.getContainerSize();this.opt.xscale=A/F[0];this.opt.yscale=G/F[1]}},initComponent:function(B){if(w.component[B]){var A=Array.prototype.slice.call(arguments);var C=new w.component[B];A.shift();A.unshift(this);C.init.apply(C,A);return C}},setOptions:function(B,A){if(!g.isPlainObject(B)){B={}}g.extend(this.opt,B);if(this.opt.setSelect){if(!this.ui.multi.length){this.newSelection()}this.setSelect(this.opt.setSelect);this.opt.setSelect=null}this.event.trigger("configupdate");return this},destroy:function(){if(this.opt.imgsrc){this.container.before(this.opt.imgsrc);this.container.remove();g(this.opt.imgsrc).removeData("Jcrop").show()}else{this.container.remove()}},applyFilters:function(){var D;for(var B=0,C=this.opt.applyFilters,A=C.length;B<A;B++){if(g.Jcrop.filter[C[B]]){D=new g.Jcrop.filter[C[B]]}D.core=this;if(D.init){D.init()}this.filter[C[B]]=D}},getDefaultFilters:function(){var D=[];for(var B=0,C=this.opt.applyFilters,A=C.length;B<A;B++){if(this.filter.hasOwnProperty(C[B])){D.push(this.filter[C[B]])}}D.sort(function(E,F){return E.priority-F.priority});return D},setSelection:function(C){var A=this.ui.multi;var D=[];for(var B=0;B<A.length;B++){if(A[B]!==C){D.push(A[B])}A[B].toBack()}D.unshift(C);this.ui.multi=D;this.ui.selection=C;C.toFront();return C},getSelection:function(B){var A=this.ui.selection.get();return A},newSelection:function(A){if(!A){A=new this.opt.selectionComponent()}A.init(this);this.setSelection(A);return A},hasSelection:function(B){for(var A=0;A<this.ui.multi;A++){if(B===this.ui.multi[A]){return true}}},removeSelection:function(C){var B,D=[],A=this.ui.multi;for(var B=0;B<A.length;B++){if(C!==A[B]){D.push(A[B])}else{A[B].remove()}}return this.ui.multi=D},addFilter:function(D){for(var C=0,A=this.ui.multi,B=A.length;C<B;C++){A[C].addFilter(D)}return this},removeFilter:function(D){for(var C=0,A=this.ui.multi,B=A.length;C<B;C++){A[C].removeFilter(D)}return this},blur:function(){this.ui.selection.blur();return this},focus:function(){this.ui.selection.focus();return this},initEvents:function(){var A=this;A.container.on("selectstart",function(B){return false}).on("mousedown","."+A.opt.css_drag,A.startDrag())},maxSelect:function(){this.setSelect([0,0,this.elw,this.elh])},nudge:function(B,D){var C=this.ui.selection,A=C.get();A.x+=B;A.x2+=B;A.y+=D;A.y2+=D;if(A.x<0){A.x2=A.w;A.x=0}else{if(A.x2>this.elw){A.x2=this.elw;A.x=A.x2-A.w}}if(A.y<0){A.y2=A.h;A.y=0}else{if(A.y2>this.elh){A.y2=this.elh;A.y=A.y2-A.h}}C.element.trigger("cropstart",[C,this.unscale(A)]);C.updateRaw(A,"move");C.element.trigger("cropend",[C,this.unscale(A)])},refresh:function(){for(var B=0,C=this.ui.multi,A=C.length;B<A;B++){C[B].refresh()}},blurAll:function(){var A=this.ui.multi;for(var B=0;B<A.length;B++){if(A[B]!==sel){n.push(A[B])}A[B].toBack()}},scale:function(A){var B=this.opt.xscale,C=this.opt.yscale;return{x:A.x/B,y:A.y/C,x2:A.x2/B,y2:A.y2/C,w:A.w/B,h:A.h/C}},unscale:function(A){var B=this.opt.xscale,C=this.opt.yscale;return{x:A.x*B,y:A.y*C,x2:A.x2*B,y2:A.y2*C,w:A.w*B,h:A.h*C}},requestDelete:function(){if((this.ui.multi.length>1)&&(this.ui.selection.canDelete)){return this.deleteSelection()}},deleteSelection:function(){if(this.ui.selection){this.removeSelection(this.ui.selection);if(this.ui.multi.length){this.ui.multi[0].focus()}this.ui.selection.refresh()}},animateTo:function(A){if(this.ui.selection){this.ui.selection.animateTo(A)}return this},setSelect:function(A){if(this.ui.selection){this.ui.selection.update(w.wrapFromXywh(A))}return this},startDrag:function(){var A=this;return function(E){var B=g(E.target);var D=B.closest("."+A.opt.css_selection).data("selection");var C=B.data("ord");A.container.trigger("cropstart",[D,A.unscale(D.get())]);D.startDrag(E,C);return false}},getContainerSize:function(){return[this.container.width(),this.container.height()]},resizeContainer:function(A,B){this.container.width(A).height(B);this.refresh()},setImage:function(D,A){var C=this,B=C.opt.imgsrc;if(!B){return false}new g.Jcrop.component.ImageLoader(D,null,function(E,F){C.resizeContainer(E,F);B.src=D;g(B).width(E).height(F);C.applySizeConstraints();C.refresh();C.container.trigger("cropimage",[C,B]);if(typeof A=="function"){A.call(C,E,F)}})},update:function(A){if(this.ui.selection){this.ui.selection.update(A)}}});g.fn.Jcrop=function(B,D){B=B||{};var C=this.eq(0).data("Jcrop");var A=Array.prototype.slice.call(arguments);if(B=="api"){return C}else{if(C&&(typeof B=="string")){if(C[B]){A.shift();C[B].apply(C,A);return C}return false}}this.each(function(){var E=this,H=g(this);var F=H.data("Jcrop");var G;if(F){F.setOptions(B)}else{if(!B.stageConstructor){B.stageConstructor=g.Jcrop.stageConstructor}B.stageConstructor(this,B,function(J,I){var K=I.setSelect;if(K){delete (I.setSelect)}var L=g.Jcrop.attach(J.element,I);if(typeof J.attach=="function"){J.attach(L)}H.data("Jcrop",L);if(K){L.newSelection();L.setSelect(K)}if(typeof D=="function"){D.call(L)}})}return this})};var i=(function(N,T,I){var E="2.7.1",L={},ad=T.documentElement,ae="modernizr",ab=T.createElement(ae),O=ab.style,F,W={}.toString,Y=" -webkit- -moz- -o- -ms- ".split(" "),D="Webkit Moz O ms",ag=D.split(" "),P=D.toLowerCase().split(" "),ai={svg:"http://www.w3.org/2000/svg"},J={},C={},U={},aa=[],V=aa.slice,B,Z=function(ar,au,al,at){var ak,aq,an,ao,aj=T.createElement("div"),ap=T.body,am=ap||T.createElement("body");if(parseInt(al,10)){while(al--){an=T.createElement("div");an.id=at?at[al]:ae+(al+1);aj.appendChild(an)}}ak=["&#173;",'<style id="s',ae,'">',ar,"</style>"].join("");aj.id=ae;(ap?aj:am).innerHTML+=ak;am.appendChild(aj);if(!ap){am.style.background="";am.style.overflow="hidden";ao=ad.style.overflow;ad.style.overflow="hidden";ad.appendChild(am)}aq=au(aj,ar);if(!ap){am.parentNode.removeChild(am);ad.style.overflow=ao}else{aj.parentNode.removeChild(aj)}return !!aq},S=(function(){var ak={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};function aj(al,an){an=an||T.createElement(ak[al]||"div");al="on"+al;var am=al in an;if(!am){if(!an.setAttribute){an=T.createElement("div")}if(an.setAttribute&&an.removeAttribute){an.setAttribute(al,"");am=K(an[al],"function");if(!K(an[al],"undefined")){an[al]=I}an.removeAttribute(al)}}an=null;return am}return aj})(),R=({}).hasOwnProperty,ac;if(!K(R,"undefined")&&!K(R.call,"undefined")){ac=function(aj,ak){return R.call(aj,ak)}}else{ac=function(aj,ak){return((ak in aj)&&K(aj.constructor.prototype[ak],"undefined"))}}if(!Function.prototype.bind){Function.prototype.bind=function ah(al){var am=this;if(typeof am!="function"){throw new TypeError()}var aj=V.call(arguments,1),ak=function(){if(this instanceof ak){var ap=function(){};ap.prototype=am.prototype;var ao=new ap();var an=am.apply(ao,aj.concat(V.call(arguments)));if(Object(an)===an){return an}return ao}else{return am.apply(al,aj.concat(V.call(arguments)))}};return ak}}function Q(aj){O.cssText=aj}function H(ak,aj){return Q(Y.join(ak+";")+(aj||""))}function K(ak,aj){return typeof ak===aj}function M(ak,aj){return !!~(""+ak).indexOf(aj)}function af(al,aj){for(var ak in al){var am=al[ak];if(!M(am,"-")&&O[am]!==I){return aj=="pfx"?am:true}}return false}function X(ak,an,am){for(var aj in ak){var al=an[ak[aj]];if(al!==I){if(am===false){return ak[aj]}if(K(al,"function")){return al.bind(am||an)}return al}}return false}function A(an,aj,am){var ak=an.charAt(0).toUpperCase()+an.slice(1),al=(an+" "+ag.join(ak+" ")+ak).split(" ");if(K(aj,"string")||K(aj,"undefined")){return af(al,aj)}else{al=(an+" "+(P).join(ak+" ")+ak).split(" ");return X(al,aj,am)}}J.canvas=function(){var aj=T.createElement("canvas");return !!(aj.getContext&&aj.getContext("2d"))};J.canvastext=function(){return !!(L.canvas&&K(T.createElement("canvas").getContext("2d").fillText,"function"))};J.touch=function(){var aj;if(("ontouchstart" in N)||N.DocumentTouch&&T instanceof DocumentTouch){aj=true}else{Z(["@media (",Y.join("touch-enabled),("),ae,")","{#modernizr{top:9px;position:absolute}}"].join(""),function(ak){aj=ak.offsetTop===9})}return aj};J.draganddrop=function(){var aj=T.createElement("div");return("draggable" in aj)||("ondragstart" in aj&&"ondrop" in aj)};J.csstransforms=function(){return !!A("transform")};J.svg=function(){return !!T.createElementNS&&!!T.createElementNS(ai.svg,"svg").createSVGRect};J.inlinesvg=function(){var aj=T.createElement("div");aj.innerHTML="<svg/>";return(aj.firstChild&&aj.firstChild.namespaceURI)==ai.svg};J.svgclippaths=function(){return !!T.createElementNS&&/SVGClipPath/.test(W.call(T.createElementNS(ai.svg,"clipPath")))};for(var G in J){if(ac(J,G)){B=G.toLowerCase();L[B]=J[G]();aa.push((L[B]?"":"no-")+B)}}L.addTest=function(ak,al){if(typeof ak=="object"){for(var aj in ak){if(ac(ak,aj)){L.addTest(aj,ak[aj])}}}else{ak=ak.toLowerCase();if(L[ak]!==I){return L}al=typeof al=="function"?al():al;if(typeof enableClasses!=="undefined"&&enableClasses){ad.className+=" "+(al?"":"no-")+ak}L[ak]=al}return L};Q("");ab=F=null;L._version=E;L._prefixes=Y;L._domPrefixes=P;L._cssomPrefixes=ag;L.hasEvent=S;L.testProp=function(aj){return af([aj])};L.testAllProps=A;L.testStyles=Z;return L})(window,window.document);(function(){var A=new Image();A.onerror=function(){i.addTest("datauri",function(){return false})};A.onload=function(){i.addTest("datauri",function(){return(A.width==1&&A.height==1)})};A.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw=="})();g.Jcrop=w;g.Jcrop.supportsCanvas=i.canvas;g.Jcrop.supportsCanvasText=i.canvastext;g.Jcrop.supportsDragAndDrop=i.draganddrop;g.Jcrop.supportsDataURI=i.datauri;g.Jcrop.supportsSVG=i.svg;g.Jcrop.supportsInlineSVG=i.inlinesvg;g.Jcrop.supportsSVGClipPaths=i.svgclippaths;g.Jcrop.supportsCSSTransforms=i.csstransforms;g.Jcrop.supportsTouch=i.touch})(jQuery);
PrimeFaces.widget.ImageCropper=PrimeFaces.widget.DeferredWidget.extend({init:function(a){this._super(a);this.image=$(PrimeFaces.escapeClientId(this.cfg.image));this.jqCoords=$(this.jqId+"_coords");var b=this;this.cfg.onSelect=function(d){b.saveCoords(d)};this.cfg.onChange=function(d){b.saveCoords(d)};this.renderDeferred()},_render:function(){this.image.Jcrop(this.cfg)},saveCoords:function(b){var a=b.x+"_"+b.y+"_"+b.w+"_"+b.h;this.jqCoords.val(a)}});
